# ğŸš€ MicLink å¿«é€Ÿå¯åŠ¨æŒ‡å—

## âš¡ 5åˆ†é’Ÿæé€Ÿç‰ˆ

### å‰ç½®æ£€æŸ¥
- [ ] å·²å®‰è£… Go 1.21+ (`go version`)
- [ ] å·²å®‰è£… JDK 17+ (`java -version`)
- [ ] å·²å®‰è£… Android Studio æˆ–é…ç½®å¥½adb
- [ ] å‡†å¤‡å¥½ä¸¤å°Androidè®¾å¤‡ï¼ˆæˆ–1å°è®¾å¤‡+1ä¸ªæ¨¡æ‹Ÿå™¨ï¼‰
- [ ] ç”µè„‘å’Œæ‰‹æœºåœ¨åŒä¸€WiFiç½‘ç»œ

### ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨æœåŠ¡å™¨ï¼ˆ1åˆ†é’Ÿï¼‰

**Windowsï¼š**
```powershell
# åŒå‡»è¿è¡Œæˆ–åœ¨PowerShellä¸­æ‰§è¡Œ
.\start-server.bat
```

**Linux/macOSï¼š**
```bash
chmod +x start-server.sh
./start-server.sh
```

**éªŒè¯æœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼š**
- æµè§ˆå™¨è®¿é—® `http://localhost:8080/health`
- åº”è¯¥çœ‹åˆ°ï¼š`{"status":"ok","online_users":0}` âœ“

### ç¬¬äºŒæ­¥ï¼šé…ç½®IPåœ°å€ï¼ˆ30ç§’ï¼‰

#### è·å–ç”µè„‘IPåœ°å€

**Windowsï¼š**
```powershell
ipconfig
# æ‰¾ "IPv4 åœ°å€"ï¼Œä¾‹å¦‚: 192.168.1.100
```

**Linux/macOSï¼š**
```bash
ifconfig
# æˆ– ip addr show
```

#### ä¿®æ”¹é…ç½®æ–‡ä»¶

æ‰“å¼€æ–‡ä»¶ï¼š
```
android/app/src/main/kotlin/com/miclink/network/Config.kt
```

ä¿®æ”¹ç¬¬11è¡Œï¼ˆæŠŠIPæ”¹æˆä½ çš„ï¼‰ï¼š
```kotlin
private const val DEV_SERVER_IP = "192.168.1.100"  // â† æ”¹æˆä½ çš„IP
```

**âš ï¸ é‡è¦**ï¼šæ‰‹æœºå’Œç”µè„‘å¿…é¡»åœ¨åŒä¸€WiFiç½‘ç»œï¼

### ç¬¬ä¸‰æ­¥ï¼šç¼–è¯‘åº”ç”¨ï¼ˆ2åˆ†é’Ÿï¼‰

```powershell
cd android
.\gradlew assembleDebug
```

ç­‰å¾…ç¼–è¯‘å®Œæˆ...

APKä½ç½®ï¼š`android\app\build\outputs\apk\debug\app-debug.apk`

### ç¬¬å››æ­¥ï¼šå®‰è£…å’Œæµ‹è¯•ï¼ˆ1åˆ†é’Ÿï¼‰

**æ–¹æ³•Aï¼šä½¿ç”¨Android Studioï¼ˆæ¨èï¼‰**
1. ç”¨Android Studioæ‰“å¼€ `android` æ–‡ä»¶å¤¹
2. è¿æ¥è®¾å¤‡æˆ–å¯åŠ¨æ¨¡æ‹Ÿå™¨
3. ç‚¹å‡» Run â–¶ï¸

**æ–¹æ³•Bï¼šä½¿ç”¨ADB**
```powershell
# å®‰è£…åˆ°å·²è¿æ¥çš„è®¾å¤‡
adb install android\app\build\outputs\apk\debug\app-debug.apk

# å¦‚æœæç¤ºå·²å®‰è£…ï¼Œä½¿ç”¨-rå‚æ•°é‡æ–°å®‰è£…
adb install -r android\app\build\outputs\apk\debug\app-debug.apk
```

### å¼€å§‹é€šè¯

1. **ç¬¬ä¸€å°è®¾å¤‡**
   - æ‰“å¼€MicLinkåº”ç”¨
   - è¾“å…¥ç”¨æˆ·IDï¼š`user1`
   - ç‚¹å‡»"åŠ å…¥"

2. **ç¬¬äºŒå°è®¾å¤‡**
   - æ‰“å¼€MicLinkåº”ç”¨
   - è¾“å…¥ç”¨æˆ·IDï¼š`user2`
   - ç‚¹å‡»"åŠ å…¥"

3. **å‘èµ·é€šè¯**
   - åœ¨ç¬¬ä¸€å°è®¾å¤‡ä¸Šçœ‹åˆ° `user2` åœ¨çº¿
   - ç‚¹å‡» `user2` æ—è¾¹çš„ç”µè¯å›¾æ ‡

4. **æ¥å¬é€šè¯**
   - ç¬¬äºŒå°è®¾å¤‡çœ‹åˆ°æ¥ç”µ
   - ç‚¹å‡»"æ¥å¬"

5. **å¼€å§‹è¯´è¯** ğŸ‰

---

## ğŸ“– è¯¦ç»†æŒ‡å—

### æœåŠ¡å™¨å¯åŠ¨è¯¦è§£

#### æ–¹å¼1ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰

**Windowsï¼š**
```powershell
.\start-server.bat
```

**Linux/macOSï¼š**
```bash
./start-server.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. æ£€æŸ¥Goç¯å¢ƒ
2. æ‹‰å–ä¾èµ–åŒ…
3. ç¼–è¯‘æœåŠ¡å™¨
4. ç›‘å¬ :8080 ç«¯å£

çœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯è¡¨ç¤ºæˆåŠŸï¼š
```
MicLink Signaling Server starting on :8080
```

#### æ–¹å¼2ï¼šæ‰‹åŠ¨å¯åŠ¨

```bash
cd server
go mod download      # ä¸‹è½½ä¾èµ–
go run cmd/server/main.go
```

### å®¢æˆ·ç«¯é…ç½®è¯¦è§£

#### IPé…ç½®ä¸‰ç§æ–¹å¼

**æ–¹å¼1ï¼šæœ¬æœºæµ‹è¯•ï¼ˆæ¨èåˆå­¦è€…ï¼‰**
```kotlin
private const val DEV_SERVER_IP = "192.168.1.100"  // ä½ çš„ç”µè„‘IP
```

**æ–¹å¼2ï¼šDockerå®¹å™¨**
```kotlin
private const val DEV_SERVER_IP = "docker.for.mac.localhost"  // macOS Docker
private const val DEV_SERVER_IP = "172.17.0.1"                // Linux Docker
```

**æ–¹å¼3ï¼šè¿œç¨‹æœåŠ¡å™¨**
```kotlin
private const val DEV_SERVER_IP = "example.com"  // æˆ– IPåœ°å€
```

#### æ£€æŸ¥ç½‘ç»œè¿æ¥

```powershell
# æµ‹è¯•æœåŠ¡å™¨æ˜¯å¦å¯è¾¾
ping 192.168.1.100

# æµ‹è¯•WebSocketç«¯å£
# åœ¨æ‰‹æœºæµè§ˆå™¨è®¿é—®
http://192.168.1.100:8080/health
```

### ç¼–è¯‘é€‰é¡¹

#### å¿«é€Ÿè°ƒè¯•ç‰ˆæœ¬
```powershell
cd android
.\gradlew assembleDebug
```

#### å‘å¸ƒç‰ˆæœ¬ï¼ˆéœ€è¦ç­¾åï¼‰
```powershell
cd android
.\gradlew assembleRelease
```

#### ç›´æ¥å®‰è£…åˆ°è®¾å¤‡
```powershell
cd android
.\gradlew installDebug
```

### æµ‹è¯•åœºæ™¯

#### åœºæ™¯1ï¼šæœ¬åœ°WiFiæµ‹è¯•
```
è®¾å¤‡1 â”€â”€WiFiâ”€â”€â”¬â”€â”€ æœåŠ¡å™¨ (PC)
             â”‚
è®¾å¤‡2 â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
**é…ç½®**ï¼šæ‰€æœ‰è®¾å¤‡ä½¿ç”¨åŒä¸€WiFiï¼ŒIPä¸ºPCçš„å†…ç½‘IP

#### åœºæ™¯2ï¼šæ¨¡æ‹Ÿå™¨ + çœŸæœº
```
æ¨¡æ‹Ÿå™¨ â”€â”€USBâ”€â”€â”€ PC â”€â”€ WiFi â”€â”€ çœŸæœº
```
**é…ç½®**ï¼š
- æ¨¡æ‹Ÿå™¨ï¼š`DEV_SERVER_IP = "10.0.2.2"`ï¼ˆAndroidæ¨¡æ‹Ÿå™¨è®¿é—®PCçš„ç‰¹æ®ŠIPï¼‰
- çœŸæœºï¼š`DEV_SERVER_IP = "PCçš„WiFi IP"`

#### åœºæ™¯3ï¼šä¸¤ä¸ªæ¨¡æ‹Ÿå™¨
```
æ¨¡æ‹Ÿå™¨1 â”€â”€â”
          PC â”€â”€ :8080
æ¨¡æ‹Ÿå™¨2 â”€â”€â”˜
```
**é…ç½®**ï¼šä¸¤ä¸ªæ¨¡æ‹Ÿå™¨éƒ½ä½¿ç”¨ `DEV_SERVER_IP = "10.0.2.2"`

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: æœåŠ¡å™¨æ— æ³•å¯åŠ¨

**ç—‡çŠ¶**ï¼š`listen tcp :8080: bind: address already in use`

**åŸå› **ï¼š8080ç«¯å£å·²è¢«å ç”¨

**è§£å†³**ï¼š
```powershell
# Windows - æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
netstat -ano | findstr :8080

# ç»“æŸè¿›ç¨‹
taskkill /PID <PID> /F
```

### Q2: Androidå®¢æˆ·ç«¯æ— æ³•è¿æ¥æœåŠ¡å™¨

**ç—‡çŠ¶**ï¼šæ˜¾ç¤º"è¿æ¥ä¸­..."æˆ–"è¿æ¥å¤±è´¥"

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥æœåŠ¡å™¨è¿è¡Œï¼šæµè§ˆå™¨è®¿é—® `http://localhost:8080/health`
2. æ£€æŸ¥IPé…ç½®ï¼š`Config.kt` ä¸­çš„ `DEV_SERVER_IP` æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥ç½‘ç»œï¼šæ‰‹æœºå’Œç”µè„‘åœ¨åŒä¸€WiFiï¼Ÿ
4. æ£€æŸ¥é˜²ç«å¢™ï¼šå…è®¸8080ç«¯å£ï¼Ÿ

**è§£å†³**ï¼š
```powershell
# Windows - æŸ¥çœ‹IP
ipconfig

# ä¸´æ—¶å…³é—­é˜²ç«å¢™æµ‹è¯•
# æ§åˆ¶é¢æ¿ -> Windows Defender é˜²ç«å¢™ -> å…³é—­

# æˆ–æ·»åŠ é˜²ç«å¢™è§„åˆ™
netsh advfirewall firewall add rule name="MicLink" dir=in action=allow protocol=TCP localport=8080
```

### Q3: ç¼–è¯‘å¤±è´¥

**ç—‡çŠ¶**ï¼š`Gradle sync failed` æˆ– `Task failed`

**åŸå› **ï¼šä¾èµ–ä¸‹è½½å¤±è´¥

**è§£å†³**ï¼š
```powershell
# æ¸…é™¤æ„å»ºç¼“å­˜
cd android
.\gradlew clean

# é‡æ–°åŒæ­¥
.\gradlew sync

# é‡æ–°ç¼–è¯‘
.\gradlew assembleDebug
```

### Q4: ä¸¤å°è®¾å¤‡æ— æ³•é€šè¯

**ç—‡çŠ¶**ï¼šå‘èµ·é€šè¯åå¯¹æ–¹çœ‹ä¸åˆ°æ¥ç”µ

**æ’æŸ¥**ï¼š
1. ä¸¤ä¸ªè®¾å¤‡éƒ½èƒ½çœ‹åˆ°å¯¹æ–¹IDï¼Ÿ
2. æœåŠ¡å™¨æ—¥å¿—æœ‰é”™è¯¯ï¼Ÿ
3. WebSocketè¿æ¥æ­£å¸¸ï¼Ÿ

**è°ƒè¯•**ï¼š
```bash
# æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—
adb logcat | findstr MicLink

# æŸ¥çœ‹WebSocketè¿æ¥çŠ¶æ€
# Chromeè®¿é—® chrome://webrtc-internals
```

### Q5: æ²¡æœ‰å£°éŸ³

**ç—‡çŠ¶**ï¼šé€šè¯è¿æ¥æˆåŠŸä½†å¬ä¸åˆ°å£°éŸ³

**åŸå› **ï¼šéº¦å…‹é£æƒé™æˆ–éŸ³é¢‘è®¾å¤‡é—®é¢˜

**è§£å†³**ï¼š
1. æˆäºˆéº¦å…‹é£æƒé™ï¼šåº”ç”¨ -> æƒé™ -> éº¦å…‹é£
2. æ£€æŸ¥éŸ³é‡ï¼šä¸è¦æŒ‰äº†é™éŸ³æŒ‰é’®
3. åˆ‡æ¢æ‰¬å£°å™¨ï¼šè¯•è¯•å¬ç­’/æ‰¬å£°å™¨åˆ‡æ¢
4. æ£€æŸ¥éº¦å…‹é£ï¼šç”¨å…¶ä»–Appæµ‹è¯•éº¦å…‹é£æ˜¯å¦æ­£å¸¸

---

## ğŸ”§ é«˜çº§é…ç½®

### è‡ªå®šä¹‰éŸ³è´¨

æ‰“å¼€ `HomeScreen.kt`ï¼Œä¿®æ”¹é»˜è®¤éŸ³è´¨ï¼š
```kotlin
var audioQuality by remember { mutableStateOf(AudioQuality.MEDIUM) }
// æ”¹ä¸º
var audioQuality by remember { mutableStateOf(AudioQuality.HIGH) }
```

### è‡ªå®šä¹‰è¿æ¥æ¨¡å¼

```kotlin
var connectionMode by remember { mutableStateOf(ConnectionMode.AUTO) }
// æ”¹ä¸º
var connectionMode by remember { mutableStateOf(ConnectionMode.P2P_ONLY) }
```

### ä¿®æ”¹æœåŠ¡å™¨ç«¯å£

**Androidå®¢æˆ·ç«¯** (`Config.kt`)ï¼š
```kotlin
private const val DEV_SERVER_PORT = 8080  // æ”¹æˆä½ çš„ç«¯å£
```

**GoæœåŠ¡å™¨** (`server/cmd/main.go`)ï¼š
```go
router.Run(":8080")  // æ”¹æˆä½ çš„ç«¯å£
```

### å¯ç”¨è¯¦ç»†æ—¥å¿—

**Androidå®¢æˆ·ç«¯** (`Config.kt`)ï¼š
```kotlin
const val DEBUG_ENABLED = true  // å¯ç”¨è¯¦ç»†æ—¥å¿—
```

**æŸ¥çœ‹æ—¥å¿—**ï¼š
```powershell
adb logcat | findstr MicLink
```

---

## âœ… æµ‹è¯•æ£€æŸ¥æ¸…å•

### åŠŸèƒ½æµ‹è¯•
- [ ] æœåŠ¡å™¨æˆåŠŸå¯åŠ¨
- [ ] APKæˆåŠŸç¼–è¯‘å’Œå®‰è£…
- [ ] Appå¯åŠ¨æ—¶è¯·æ±‚éº¦å…‹é£æƒé™
- [ ] å¯ä»¥è¾“å…¥ç”¨æˆ·IDå¹¶åŠ å…¥
- [ ] å¯ä»¥çœ‹åˆ°åœ¨çº¿ç”¨æˆ·åˆ—è¡¨
- [ ] å¯ä»¥å‘èµ·é€šè¯
- [ ] å¯¹æ–¹æ”¶åˆ°æ¥ç”µæç¤º
- [ ] å¯ä»¥æ¥å¬é€šè¯
- [ ] é€šè¯ä¸­æœ‰æ¸…æ™°çš„å£°éŸ³
- [ ] é™éŸ³æŒ‰é’®æ­£å¸¸å·¥ä½œ
- [ ] æ‰¬å£°å™¨åˆ‡æ¢æ­£å¸¸
- [ ] æŒ‚æ–­æŒ‰é’®æ­£å¸¸å·¥ä½œ
- [ ] åº”ç”¨åˆ‡åå°åé€šè¯ç»§ç»­ä¿æŒ
- [ ] é”å±çŠ¶æ€ä¸‹æ¥ç”µèƒ½æ­£å¸¸æ˜¾ç¤º
- [ ] è“ç‰™è€³æœºèƒ½æ­£ç¡®æ˜¾ç¤ºå’Œåˆ‡æ¢

### ç½‘ç»œæµ‹è¯•
- [ ] WiFiè¿æ¥æ­£å¸¸
- [ ] P2Pç›´è¿æˆåŠŸ
- [ ] è‡ªåŠ¨é™çº§åˆ°ä¸­è½¬
- [ ] ç½‘ç»œåˆ‡æ¢è‡ªåŠ¨æ¢å¤

### èµ„æºæµ‹è¯•
- [ ] å†…å­˜å ç”¨ < 100MB
- [ ] CPUå ç”¨ < 10%ï¼ˆé€šè¯ä¸­ï¼‰
- [ ] ç”µæ± æ¶ˆè€—æ­£å¸¸
- [ ] ä¸ä¼šè¿‡åº¦å‘çƒ­

---

## ğŸ“ è·å–å¸®åŠ©

- **æ–‡æ¡£**ï¼šæŸ¥çœ‹ [docs/](.) ç›®å½•ä¸‹çš„å…¶ä»–æ–‡æ¡£
- **é—®é¢˜**ï¼šæŸ¥çœ‹ [TESTING.md](TESTING.md) çš„æ•…éšœæ’æŸ¥éƒ¨åˆ†
- **æ·±åº¦æŠ€æœ¯**ï¼šæŸ¥çœ‹ [ARCHITECTURE.md](ARCHITECTURE.md)
- **ç”Ÿäº§éƒ¨ç½²**ï¼šæŸ¥çœ‹ [DEPLOYMENT.md](DEPLOYMENT.md)

---

## ğŸ‰ æ­å–œï¼

ä½ ç°åœ¨å·²ç»æˆåŠŸè¿è¡Œäº†MicLinkï¼

**ä¸‹ä¸€æ­¥**ï¼š
1. è¯»ä¸€ä¸‹ [ARCHITECTURE.md](ARCHITECTURE.md) äº†è§£ç³»ç»Ÿè®¾è®¡
2. æŸ¥çœ‹ [API.md](API.md) ç†è§£é€šä¿¡åè®®
3. æ ¹æ®éœ€è¦ä¿®æ”¹ [DEPLOYMENT.md](DEPLOYMENT.md) ä¸­çš„é…ç½®è¿›è¡Œç”Ÿäº§éƒ¨ç½²

**ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼** ğŸš€
